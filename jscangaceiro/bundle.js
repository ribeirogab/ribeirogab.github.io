webpackJsonp([1],[,function(a,b,c){"use strict";function d(a){return a instanceof l||Object.getPrototypeOf(a)instanceof l}function e(a){return d(a)?a.message:(console.error(a),"Could not perform the operation!")}function f(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d("next",a)},function(a){d("throw",a)})}return d("next")})}}function g(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d("next",a)},function(a){d("throw",a)})}return d("next")})}}function h(a){throw new Error(`${a} is a required param!`)}function i(a=500){return(b,c,d)=>{const e=d.value;let f=0;return d.value=function(...b){event&&event.preventDefault(),clearTimeout(f),f=setTimeout(()=>e.apply(this,b),a)},d}}function j(...a){const b=a.map((a)=>document.querySelector(a));return function(a){const c=a,d=function(){return new c(...b)};return d.prototype=c.prototype,d}}Object.defineProperty(b,"__esModule",{value:!0});let k=class extends Error{constructor(a=""){super(a),this.name=this.constructor.name}};const l=k;let m=class{static create(a,b,c){return new Proxy(a,{get(a,d){return b.includes(d)&&typeof a[d]==typeof Function?function(){console.log(`"${d}" shot the trap`),Reflect.apply(a[d],a,arguments),c(a)}:Reflect.get(a,d)},set(a,d,e,f){return b.includes(d)&&(console.log(`"${d}" shot the trap`),Reflect.set(a,d,e),c(a)),Reflect.set(a,d,e,f)}})}},n=class{constructor(a,b,...c){const d=m.create(a,c,(a)=>b.update(a));return b.update(a),d}},o=null;const p=["trades"];let q=null,r=class a{constructor(){throw new Error("This class cannot be instantiated!")}static getConnection(){return new Promise((b,c)=>{const d=indexedDB.open("jscangaceiro",1);return o?b(o):void(d.onupgradeneeded=(b)=>{a._createStores(b.target.result)},d.onsuccess=(a)=>{o=a.target.result,q=o.close.bind(o),o.close=()=>{throw new Error("You cannot directly close this connection!")},b(a.target.result)},d.onerror=(a)=>{console.log(a.target.error),c(a.target.error.name)})})}static _createStores(a){p.forEach((b)=>{a.objectStoreNames.contains(b)&&a.deleteObjectStore(b),a.createObjectStore(b,{autoIncrement:!0})})}static closeConnection(){o&&q()}};var s=c(3);let t=(()=>{var a=f(function*(){const a=yield r.getConnection();return new s.b(a)});return function(){return a.apply(this,arguments)}})(),u=class extends k{constructor(){super("http Error")}},v=class{get(a){var b=this;return g(function*(){const c=yield b._handleErrors((yield fetch(a)));return c.json()})()}post(a,b){var c=this;return g(function*(){const d=yield fetch(a,{headers:{"Content-type":"application/json"},method:"post",body:JSON.stringify(b)});return yield c._handleErrors(d)})()}_handleErrors(a){return g(function*(){if(!a.ok)throw new Error(a.statusText);return a})()}};c.d(b,"a",function(){return k}),c.d(b,!1,function(){return d}),c.d(b,"f",function(){return e}),c.d(b,"b",function(){return n}),c.d(b,!1,function(){return r}),c.d(b,"g",function(){return t}),c.d(b,!1,function(){return u}),c.d(b,"c",function(){return v}),c.d(b,!1,function(){return m}),c.d(b,"h",function(){return h}),c.d(b,"e",function(){return i}),c.d(b,"d",function(){return j})},function(a,b,c){"use strict";c.d(b,"a",function(){return e});var d=c(1);let e=class{constructor(a=d.h("date"),b=d.h("amount"),c=d.h("value")){this._date=new Date(a.getTime()),Object.assign(this,{_amount:b,_value:c}),Object.freeze(this)}get volume(){return this._amount*this._value}get date(){return new Date(this._date.getTime())}get amount(){return this._amount}get value(){return this._value}equals(a){return JSON.stringify(this)===JSON.stringify(a)}}},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(2);let e=class{constructor(a){this._connection=a,this._store="trades"}add(a){return new Promise((b,c)=>{const d=this._connection.transaction([this._store],"readwrite").objectStore(this._store).add(a);d.onsuccess=()=>b(),d.onerror=(a)=>{console.log(a.target.error),c(a.target.error.name)}})}deleteAll(){return new Promise((a,b)=>{const c=this._connection.transaction([this._store],"readwrite").objectStore(this._store).clear();c.onsuccess=()=>a(),c.onerror=(a)=>{b(a.target.error)}})}listAll(){return new Promise((a,b)=>{const c=[],e=this._connection.transaction([this._store],"readwrite").objectStore(this._store).openCursor();e.onsuccess=(b)=>{const e=b.target.result;e?(c.push(new d.a(e.value._date,e.value._amount,e.value._value)),e.continue()):a(c)},e.onerror=(a)=>{console.log(a.target.error),b(a.target.error.name)}})}},f=class{constructor(){this._list=[],Object.freeze(this)}get list(){return[].concat(this._list)}get totalVolume(){return this._list.reduce((a,b)=>a+b.volume,0)}add(a){this._list.push(a)}delete(){this._list.length=0}order(a){this._list.sort(a)}reverse(){this._list.reverse()}};var g=c(2);c.d(b,"a",function(){return g.a}),c.d(b,"b",function(){return e}),c.d(b,"c",function(){return f})},,function(a,b,c){"use strict";function d(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d("next",a)},function(a){d("throw",a)})}return d("next")})}}function e(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}function f(){return v}Object.defineProperty(b,"__esModule",{value:!0});let g=class{constructor(a){this._selector=a}template(){throw new Error("This method needs to be overwritten")}update(a){this._selector.innerHTML=this.template(a)}},h=class extends g{template(a){return a.text?`<p class="alert alert-info">${a.text}</p>`:"<p></p>"}},i=class extends g{constructor(a){super(a),a.addEventListener("click",(a)=>{"TH"===a.target.nodeName&&f().order(a.target.textContent.toLowerCase())})}template(a){return`
    <table class="table table-hover table-bordered">
        <thead>
            <tr>
                <th>DATE</th>
                <th>AMOUNT</th>
                <th>VALUE</th>
                <th>VOLUME</th>
            </tr>
        </thead>
    
        <tbody>
            ${a.list.map((a)=>`<tr>
                <td>${m.dateToText(a.date)}</td>
                <td>${a.amount}</td>
                <td>${a.value}</td>
                <td>${a.volume}</td>
              </tr>`).join("")}
        </tbody>
    
        <tfoot>
            <td colspan=3></td>
            <td>
                ${a.totalVolume}
            </td>
        </tfoot>
    </table>
    `}},j=class{constructor(a=""){this._text=a}get text(){return this._text}set text(a){this._text=a}};var k=c(1);let l=class extends k.a{constructor(){super("This date is not in DD-MM-YYYY format")}},m=class{static textToDate(a){if(!/\d{2}\/\d{2}\/\d{4}$/.test(a))throw new l;return new Date(a.split("/").reverse())}static dateToText(a){return`${a.getDate()}/${a.getMonth()+1}/${a.getFullYear()}`}};var n,o,p,q,r,s=c(3),t=c(1);let u=(n=t.d("#data","#quantidade","#valor"),o=t.e(250),p=t.e(300),n(q=(r=class{constructor(a,b,c){this._inputDate=a,this._inputAmount=b,this._inputValue=c;const d=document.querySelector.bind(document);this._tradeList=new t.b(new s.c(),new i(d("#tradesView")),"add","delete","import","order","reverse"),this._message=new t.b(new j(),new h(d("#messageView")),"text"),this._currentOrder="",this._init()}_init(){var a=this;return d(function*(){try{const b=yield t.g(),c=yield b.listAll();c.forEach(function(b){a._tradeList.add(b)})}catch(b){a._message.text=t.f(b)}})()}add(a){var b=this;return d(function*(){try{a.preventDefault();const c=yield t.g();yield c.add(b._createTrade()),b._tradeList.add(b._createTrade()),b._message.text="Trades successfully added!",b._resetForm(),console.log(b._tradeList)}catch(a){b._message.text=t.f(a)}})()}delete(){var a=this;return d(function*(){try{const b=yield t.g();yield b.deleteAll(),a._tradeList.delete(),a._message.text="Successfully deleted!"}catch(b){a._message.text=t.f(b)}})()}import(){var a=this;return d(function*(){try{const{TradeService:b}=yield c.e(0).then(c.bind(null,25)),d=new b,e=yield Promise.all([d.import("semana"),d.import("anterior"),d.import("retrasada")]);e.reduce(function(a,b){return a.concat(b)},[]).filter(function(b){return!a._tradeList.list.some(function(a){return b.equals(a)})}).map(function(b){return a._tradeList.add(b)}),a._message.text="Trades imported successfully"}catch(b){a._message.text=t.f(b)}})()}order(c){this._currentOrder===c?this._tradeList.reverse():this._tradeList.order((d,a)=>d[c]-a[c]),this._currentOrder=c}_createTrade(){return new s.a(m.textToDate(this._inputDate.value),parseInt(this._inputAmount.value),parseFloat(this._inputValue.value))}_resetForm(){this._inputDate.value="",this._inputAmount.value=1,this._inputValue.value=0,this._inputDate.focus()}},e(r.prototype,"add",[o],Object.getOwnPropertyDescriptor(r.prototype,"add"),r.prototype),e(r.prototype,"import",[p],Object.getOwnPropertyDescriptor(r.prototype,"import"),r.prototype),r))||q);const v=new u;var w=c(6),x=c.n(w),y=c(7),z=c.n(y),A=c(4),B=c.n(A),C=c(8),D=c.n(C);const E=f();document.querySelector(".form").addEventListener("submit",E.add.bind(E)),document.querySelector("#btnDelete").addEventListener("click",E.delete.bind(E)),document.querySelector("#btnImport").addEventListener("click",E.import.bind(E))},function(){},function(){},function(){}],[5]);